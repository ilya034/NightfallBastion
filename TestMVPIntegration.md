# –¢–µ—Å—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ MVP —Å ECS

## –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### ‚úÖ –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- [x] `IEvent` - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å–æ–±—ã—Ç–∏–π
- [x] `EventBus` - —à–∏–Ω–∞ —Å–æ–±—ã—Ç–∏–π
- [x] `ICommand` - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–æ–º–∞–Ω–¥  
- [x] `CommandBus` - —à–∏–Ω–∞ –∫–æ–º–∞–Ω–¥
- [x] `ViewModelCache` - –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ ViewModels

### ‚úÖ –ò–≥—Ä–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è
- [x] `EntityCreatedEvent` - —Å–æ–∑–¥–∞–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏
- [x] `EntityDestroyedEvent` - —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏
- [x] `ComponentChangedEvent` - –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
- [x] `HealthChangedEvent` - –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∑–¥–æ—Ä–æ–≤—å—è
- [x] `CameraChangedEvent` - –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã

### ‚úÖ –ò–≥—Ä–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã
- [x] `MoveEntityCommand` - –¥–≤–∏–∂–µ–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏
- [x] `SelectEntityCommand` - –≤—ã–±–æ—Ä —Å—É—â–Ω–æ—Å—Ç–∏
- [x] `SpawnEnemyCommand` - —Å–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–∞–≥–∞
- [x] `DamageEntityCommand` - –Ω–∞–Ω–µ—Å–µ–Ω–∏–µ —É—Ä–æ–Ω–∞
- [x] `MoveCameraCommand` - –¥–≤–∏–∂–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã
- [x] `ZoomCameraCommand` - –∑—É–º –∫–∞–º–µ—Ä—ã

### ‚úÖ Event-Aware —Å–∏—Å—Ç–µ–º—ã
- [x] `EventAwareMovementSystem` - —Å–∏—Å—Ç–µ–º–∞ –¥–≤–∏–∂–µ–Ω–∏—è —Å —Å–æ–±—ã—Ç–∏—è–º–∏
- [x] `EventAwareHealthSystem` - —Å–∏—Å—Ç–µ–º–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å —Å–æ–±—ã—Ç–∏—è–º–∏
- [x] `CommandProcessingSystem` - —Å–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–º–∞–Ω–¥

### ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- [x] `GameWorld` - –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å CommandBus –∏ EventBus
- [x] `GameWorldPresenter` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å–æ–±—ã—Ç–∏—è
- [x] `ViewModelCache` - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ ViewModels

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤–≤–æ–¥–∞ (Input ‚Üí ECS)
```
InputHandler ‚Üí GameWorldPresenter ‚Üí CommandBus ‚Üí ECS Systems
```

1. `InputHandler` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤–≤–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. `GameWorldPresenter` —Å–æ–∑–¥–∞–µ—Ç –∫–æ–º–∞–Ω–¥—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–≤–æ–¥–∞
3. `CommandBus` —Å—Ç–∞–≤–∏—Ç –∫–æ–º–∞–Ω–¥—ã –≤ –æ—á–µ—Ä–µ–¥—å
4. ECS —Å–∏—Å—Ç–µ–º—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç –∫–æ–º–∞–Ω–¥—ã –∏ –∏–∑–º–µ–Ω—è—é—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ (ECS ‚Üí View)
```
ECS Systems ‚Üí EventBus ‚Üí GameWorldPresenter ‚Üí ViewModelCache ‚Üí View
```

1. ECS —Å–∏—Å—Ç–µ–º—ã –ø—É–±–ª–∏–∫—É—é—Ç —Å–æ–±—ã—Ç–∏—è –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
2. `EventBus` –¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏—è –ø–æ–¥–ø–∏—Å—á–∏–∫–∞–º
3. `GameWorldPresenter` –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –∏ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –∫—ç—à
4. `ViewModelCache` —Å–æ–∑–¥–∞–µ—Ç/–æ–±–Ω–æ–≤–ª—è–µ—Ç ViewModels —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
5. View –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### üöÄ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- ViewModels —Å–æ–∑–¥–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ª–∏—à–Ω–∏–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
- Event-driven –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤–º–µ—Å—Ç–æ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ polling

### üîí –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
- ECS —Å–ª–æ–π –Ω–µ –∑–Ω–∞–µ—Ç –æ UI
- UI —Å–ª–æ–π –Ω–µ –∑–Ω–∞–µ—Ç –æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–æ—Å—Ç—è—Ö ECS
- –ö–æ–º–∞–Ω–¥—ã –∏ —Å–æ–±—ã—Ç–∏—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç —á–µ—Ç–∫–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã

### üß™ –¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å
- –ö–æ–º–∞–Ω–¥—ã –º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ
- –°–æ–±—ã—Ç–∏—è –º–æ–∂–Ω–æ –º–æ–∫–∞—Ç—å –¥–ª—è unit-—Ç–µ—Å—Ç–æ–≤
- –ö–∞–∂–¥—ã–π —Å–ª–æ–π —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ

### üìà –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
- –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã –∏ —Å–æ–±—ã—Ç–∏—è
- –ù–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è UI
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å—É—â–Ω–æ—Å—Ç–µ–π

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–∞–≥–∞ –ø–æ –∫–ª–∏–∫—É –º—ã—à–∏
```csharp
// –í GameWorldPresenter
if (gameplayInput.RightMouseClicked)
{
    var worldPosition = _gameWorld.ScreenToWorld(mousePosition);
    _commandBus.EnqueueCommand(new SpawnEnemyCommand(worldPosition, EnemyType.boy));
}
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∑–¥–æ—Ä–æ–≤—å—è
```csharp
// –í EventAwareHealthSystem
_eventBus.Publish(new HealthChangedEvent(entity, newHealth, maxHealth));

// –í GameWorldPresenter
private void OnHealthChanged(HealthChangedEvent evt)
{
    _viewModelCache.InvalidateEntity(evt.Entity.Id);
}
```

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ ViewModels
```csharp
// ViewModelCache –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏
var enemyViewModels = _viewModelCache.GetEntityViewModels(_gameWorld.ECSManager);
```

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –∑–∞–ø—É—Å—Ç–∏—Ç—å –∏–≥—Ä—É –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –∫–æ–º–∞–Ω–¥ –∏ —Å–æ–±—ã—Ç–∏–π
2. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** - –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
3. **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ** - –¥–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –∫–æ–º–∞–Ω–¥ –¥–ª—è Tower Defense –º–µ—Ö–∞–Ω–∏–∫
4. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - —Å–æ–∑–¥–∞—Ç—å —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

## –†–µ—à–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

‚úÖ **–ù–∞—Ä—É—à–µ–Ω–∏–µ –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏–∏** - Presenter –±–æ–ª—å—à–µ –Ω–µ –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –∫ ECS  
‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - ViewModels –∫—ç—à–∏—Ä—É—é—Ç—Å—è –∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö  
‚úÖ **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–æ–±—ã—Ç–∏–π–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã** - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å–æ–±—ã—Ç–∏–π  
‚úÖ **–¢–µ—Å–Ω–∞—è —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å** - UI –∏ ECS —Ä–∞–∑–≤—è–∑–∞–Ω—ã —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—ã –∏ —Å–æ–±—ã—Ç–∏—è  

–ù–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é! üéâ